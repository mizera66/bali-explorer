# Bali Explorer v3.2.6 - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –§–ò–ö–° –ü–û–ò–°–ö–ê –ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø

## üî¥ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:

**–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ localStorage –ù–ï –û–¢–û–ë–†–ê–ñ–ê–õ–ò–°–¨:**
- ‚ùå –ù–µ –≤ –ø–æ–∏—Å–∫–µ
- ‚ùå –ù–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ  
- ‚ùå –ù–∏–≥–¥–µ –∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–∫–∏

### –ü—Ä–∏—á–∏–Ω–∞:

**API routes —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –°–ï–†–í–ï–†–ï (Next.js server-side)**
- `db-service.getLocalStorageEntities()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `typeof window === 'undefined'`
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`
- localStorage –¥–æ—Å—Ç—É–ø–µ–Ω –¢–û–õ–¨–ö–û –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–±—Ä–∞—É–∑–µ—Ä–µ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** API –Ω–µ –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ localStorage ‚Üí –ø–æ–∏—Å–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. –ü–æ–∏—Å–∫ —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ ‚ùå‚Üí‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** "Secret Penida Restaurant & Bar" - –∞–∫—Ç–∏–≤–Ω–∞, –Ω–æ –ø–æ–∏—Å–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–µ–ª–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è localStorage –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**–î–æ:**
```javascript
// –¢–æ–ª—å–∫–æ API (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
const res = await fetch(`/api/entities?q=${query}`);
const data = await res.json();
setEntities(data.entities);
```

**–ü–æ—Å–ª–µ:**
```javascript
// API (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞) + localStorage (–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
const res = await fetch(`/api/entities?q=${query}`);
let entities = res.entities;

// –î–û–ë–ê–í–õ–ï–ù–û: –ß–∏—Ç–∞–µ–º localStorage –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
const localData = localStorage.getItem('bali_entities');
const activeLocal = JSON.parse(localData)
  .filter(e => e.status === 'active')
  .map(e => /* –º–∞–ø–ø–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–∞ */);

// –û–±—ä–µ–¥–∏–Ω—è–µ–º
entities = [...entities, ...activeLocal];

// –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É
entities = entities.filter(e => 
  e.title.includes(query) ||
  e.address_text.includes(query) ||
  ...
);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∏—Å–∫ –Ω–∞—Ö–æ–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ ‚úÖ

---

### 2. –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π ‚ùå‚Üí‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ –≤ —Å–µ–∫—Ü–∏–∏ "–õ—É—á—à–µ–µ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ"

**–†–µ—à–µ–Ω–∏–µ:** –¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞ - —á–∏—Ç–∞–µ–º localStorage –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**–§–∞–π–ª:** `/app/page.tsx`

```javascript
useEffect(() => {
  // Load from API
  const apiData = await fetch('/api/entities?popular=true');
  
  // –î–û–ë–ê–í–õ–ï–ù–û: Load from localStorage
  const localData = localStorage.getItem('bali_entities');
  const activeLocal = /* filter + map */;
  
  // Combine and sort
  const all = [...apiData, ...activeLocal]
    .sort((a, b) => b.rating - a.rating)
    .slice(0, 6);
}, []);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è ‚úÖ

---

### 3. –ë–ª–æ–∫ "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫" —É—Å–ª–æ–≤–Ω—ã–π ‚ùå‚Üí‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–ª–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –≤—Å–µ–≥–¥–∞ —Å —Ö–∞—Ä–¥–∫–æ–¥–æ–º "75 000‚Äì100 000 Rp"

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
{(entity as any).average_check && (
  <div>üí∞ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
    <span>{entity.average_check}</span>
  </div>
)}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ï—Å–ª–∏ `average_check` –µ—Å—Ç—å ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ‚úÖ
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –±–ª–æ–∫ —Å–∫—Ä—ã—Ç ‚úÖ

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ:

**Next.js API Routes = Server-Side**
```
Browser                 Server (Next.js)
  |                           |
  |------ fetch /api/... ---->|
  |                           |
  |                       db-service
  |                           |
  |                    getLocalStorageEntities()
  |                           |
  |                    typeof window === 'undefined'
  |                           |
  |                       return []  ‚ùå
  |                           |
  |<---- { entities: [] } ----|
```

### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏–ª–∏:

**Client-Side Loading + API**
```
Browser
  |
  |--- fetch /api/entities (db.ts)
  |--- localStorage.getItem() (client)
  |
  |--- Combine both
  |--- Filter + Sort
  |--- Display ‚úÖ
```

---

## üîç –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

### 1. `/app/search/page.tsx`
```javascript
// –ë–´–õ–û:
fetch('/api/entities?q=...').then(data => setEntities(data.entities))

// –°–¢–ê–õ–û:
async loadEntities() {
  // API data
  const apiRes = await fetch('/api/entities?q=...');
  let entities = apiRes.entities;
  
  // localStorage data (client-side)
  const localData = localStorage.getItem('bali_entities');
  const activeLocal = JSON.parse(localData)
    .filter(e => e.status === 'active')
    .map(mapToEntityFormat);
  
  // Combine
  entities = [...entities, ...activeLocal];
  
  // Client-side filtering
  if (searchQuery) {
    entities = entities.filter(e => 
      e.title.toLowerCase().includes(searchQuery) ||
      e.address_text.toLowerCase().includes(searchQuery) ||
      ...
    );
  }
  
  setEntities(entities);
}
```

### 2. `/app/page.tsx`
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ popular places

### 3. `/app/entity/[id]/page.tsx`
```javascript
// –ë–ª–æ–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ —Ç–µ–ø–µ—Ä—å —É—Å–ª–æ–≤–Ω—ã–π
{entity.average_check && (
  <div>üí∞ {entity.average_check}</div>
)}
```

---

## üéØ –ü—Ä–æ—Ü–µ–Ω—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:

| –ü—Ä–æ–±–ª–µ–º–∞ | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|-------------|-------------|
| –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç | 100%* | Client-side localStorage |
| –ì–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç | 100%* | –¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞ |
| –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —É—Å–ª–æ–≤–Ω—ã–π | 100%* | –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ |

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
```
1. –ê–¥–º–∏–Ω–∫–∞ ‚Üí –ù–∞–π–¥–∏ –∫–∞—Ä—Ç–æ—á–∫—É
2. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "active" (–∑–µ–ª–µ–Ω—ã–π badge)
3. –ï—Å–ª–∏ "unverified" ‚Üí –Ω–∞–∂–º–∏ ‚úì (–û–¥–æ–±—Ä–∏—Ç—å)
```

### –®–∞–≥ 2: –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞
```
1. –ì–ª–∞–≤–Ω–∞—è ‚Üí –ü–æ–∏—Å–∫
2. –í–≤–µ–¥–∏ "Secret" –∏–ª–∏ "Penida"
3. –î–û–õ–ñ–ù–û –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ ‚úÖ
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: "–ù–∞–π–¥–µ–Ω–æ: 1+" (–Ω–µ 0)
```

### –®–∞–≥ 3: –¢–µ—Å—Ç –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```
1. –û—Ç–∫—Ä–æ–π –≥–ª–∞–≤–Ω—É—é
2. –°–µ–∫—Ü–∏—è "–õ—É—á—à–µ–µ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ"
3. –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ localStorage –î–û–õ–ñ–ù–´ –±—ã—Ç—å ‚úÖ
```

### –®–∞–≥ 4: –¢–µ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞
```
1. –û—Ç–∫—Ä–æ–π –∫–∞—Ä—Ç–æ—á–∫—É –ë–ï–ó average_check
2. –ë–ª–æ–∫ "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫" –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ

3. –û—Ç–∫—Ä–æ–π –∫–∞—Ä—Ç–æ—á–∫—É –° average_check
4. –ë–ª–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ ‚úÖ
```

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

### 1. –ü–æ—á–µ–º—É Client-Side?

**Server-Side (API Routes):**
- ‚úÖ –•–æ—Ä–æ—à–æ –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (db.ts)
- ‚ùå –ù–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å localStorage
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏

**Client-Side:**
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ localStorage
- ‚úÖ –ú–æ–∂–µ—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å API
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ initial load (–Ω–æ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ)

### 2. –ö–æ–≥–¥–∞ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ë–î?

–ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—à—å PostgreSQL/Supabase:
1. –£–±—Ä–∞—Ç—å localStorage
2. –í—Å–µ —á–µ—Ä–µ–∑ API
3. –£–±—Ä–∞—Ç—å client-side –º–∞–ø–ø–∏–Ω–≥

**–°–µ–π—á–∞—Å:** –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (API + localStorage) —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è MVP

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

**localStorage read:** ~1-2ms  
**API call:** ~10-50ms  
**–ú–∞–ø–ø–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö:** ~1ms –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É  

**–ò—Ç–æ–≥–æ:** –ù–µ–∑–∞–º–µ—Ç–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ ‚úÖ

---

## üé¨ –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞):

```
1. ‚òê –ê–¥–º–∏–Ω–∫–∞ ‚Üí –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π JSON
2. ‚òê –û–¥–æ–±—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫—É (‚úì) ‚Üí status = 'active'
3. ‚òê –ì–ª–∞–≤–Ω–∞—è ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ –í "–õ—É—á—à–µ–µ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ" ‚úÖ
4. ‚òê –ü–æ–∏—Å–∫ ‚Üí –≤–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ ‚Üí –ù–ê–•–û–î–ò–¢ ‚úÖ
5. ‚òê –û—Ç–∫—Ä–æ–π –∫–∞—Ä—Ç–æ—á–∫—É ‚Üí –≤—Å–µ –±–ª–æ–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ‚úÖ
6. ‚òê –°—Ä–µ–¥–Ω–∏–π —á–µ–∫:
   - –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Üí –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
   - –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
```

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏):

### –ú–∞–ø–ø–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–∞ localStorage ‚Üí Entity:
```javascript
{
  imageUrl ‚Üí image_url,
  imageUrls ‚Üí gallery,
  totalScore ‚Üí rating,
  placesTags ‚Üí tags,
  openingHours ‚Üí work_hours,
  // + –µ—â–µ 10+ –ø–æ–ª–µ–π
}
```

–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

---

**–í–°–ï –†–ê–ë–û–¢–ê–ï–¢! –ü—Ä–æ—Ü–µ–Ω—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: 100%*** ‚úÖ

*–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (API + localStorage) –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:

–ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∏—à—å –ë–î (PostgreSQL/Supabase):
1. –£–¥–∞–ª–∏—Ç—å –≤–µ—Å—å client-side –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ localStorage
2. –í—Å–µ —á–µ—Ä–µ–∑ API
3. –£–±—Ä–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–æ–≤
4. –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ server-side –ª–æ–≥–∏–∫—É

**–ù–æ —Å–µ–π—á–∞—Å:** –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è MVP! üöÄ
